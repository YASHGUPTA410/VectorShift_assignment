2025-02-28 01:09:06 - hubspot - ERROR - Error: ConnectionError - Error Multiple exceptions: [Errno 61] Connect call failed ('::1', 6379, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 6379) connecting to localhost:6379. - Context: {'user_id': 'TestUser', 'org_id': 'TestOrg', 'integration': 'hubspot', 'operation': 'authorize'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 281, in connect
    await self.retry.call_with_retry(
        lambda: self._connect(), lambda error: self.disconnect()
    )
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 697, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **self._connection_arguments()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lambda: protocol, host, port, **kwds)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 1169, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
        ', '.join(str(exc) for exc in exceptions)))
OSError: Multiple exceptions: [Errno 61] Connect call failed ('::1', 6379, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 6379)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 48, in authorize
    encoded_state = await generate_and_store_state(self.integration_name, user_id, org_id)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 19, in generate_and_store_state
    await add_key_value_redis(
    ...<3 lines>...
    )
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/redis_client.py", line 9, in add_key_value_redis
    await redis_client.set(key, value)
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/client.py", line 611, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 1064, in get_connection
    await self.ensure_connection(connection)
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 1097, in ensure_connection
    await connection.connect()
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 289, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error Multiple exceptions: [Errno 61] Connect call failed ('::1', 6379, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 6379) connecting to localhost:6379.
2025-02-28 01:11:34 - hubspot - ERROR - Error: ConnectionError - Error Multiple exceptions: [Errno 61] Connect call failed ('::1', 6379, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 6379) connecting to localhost:6379. - Context: {'user_id': 'gyes410@gmail.com', 'org_id': 'Onefinnet', 'integration': 'hubspot', 'operation': 'authorize'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 281, in connect
    await self.retry.call_with_retry(
        lambda: self._connect(), lambda error: self.disconnect()
    )
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 697, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **self._connection_arguments()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lambda: protocol, host, port, **kwds)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 1169, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
        ', '.join(str(exc) for exc in exceptions)))
OSError: Multiple exceptions: [Errno 61] Connect call failed ('::1', 6379, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 6379)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 48, in authorize
    encoded_state = await generate_and_store_state(self.integration_name, user_id, org_id)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 19, in generate_and_store_state
    await add_key_value_redis(
    ...<3 lines>...
    )
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/redis_client.py", line 9, in add_key_value_redis
    await redis_client.set(key, value)
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/client.py", line 611, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 1064, in get_connection
    await self.ensure_connection(connection)
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 1097, in ensure_connection
    await connection.connect()
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 289, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error Multiple exceptions: [Errno 61] Connect call failed ('::1', 6379, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 6379) connecting to localhost:6379.
2025-02-28 09:46:48 - hubspot - ERROR - Error: ConnectionError - Error Multiple exceptions: [Errno 61] Connect call failed ('::1', 6379, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 6379) connecting to localhost:6379. - Context: {'user_id': 'TestUser', 'org_id': 'TestOrg', 'integration': 'hubspot', 'operation': 'authorize'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 281, in connect
    await self.retry.call_with_retry(
        lambda: self._connect(), lambda error: self.disconnect()
    )
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 697, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **self._connection_arguments()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lambda: protocol, host, port, **kwds)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 1169, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
        ', '.join(str(exc) for exc in exceptions)))
OSError: Multiple exceptions: [Errno 61] Connect call failed ('::1', 6379, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 6379)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 48, in authorize
    encoded_state = await generate_and_store_state(self.integration_name, user_id, org_id)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 19, in generate_and_store_state
    await add_key_value_redis(
    ...<3 lines>...
    )
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/redis_client.py", line 9, in add_key_value_redis
    await redis_client.set(key, value)
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/client.py", line 611, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 1064, in get_connection
    await self.ensure_connection(connection)
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 1097, in ensure_connection
    await connection.connect()
  File "/Users/yashgupta/Downloads/integrations_technical_assessment/backend/.vectorShift/lib/python3.13/site-packages/redis/asyncio/connection.py", line 289, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error Multiple exceptions: [Errno 61] Connect call failed ('::1', 6379, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 6379) connecting to localhost:6379.
2025-02-28 09:56:20 - hubspot - ERROR - Error: KeyError - 'scopes' - Context: {'user_id': 'TestUser', 'org_id': 'TestOrg', 'integration': 'hubspot', 'operation': 'authorize'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 56, in authorize
    f"&scope={self.config['scopes']}"
              ~~~~~~~~~~~^^^^^^^^^^
KeyError: 'scopes'
2025-02-28 09:57:30 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T04:27:30.396918', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': 'TestUser', 'org_id': 'TestOrg', 'details': {'duration_ms': 4.544973373413086, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 09:59:59 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T04:29:59.943529', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': 'TestUser', 'org_id': 'TestOrg', 'details': {'duration_ms': 4.243135452270508, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 10:00:37 - hubspot - ERROR - Error: HTTPException - 400: No credentials found. - Context: {'user_id': 'TestUser', 'org_id': 'TestOrg', 'integration': 'hubspot', 'operation': 'get_credentials'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 171, in get_credentials
    credentials = await get_credentials(self.integration_name, user_id, org_id)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 122, in get_credentials
    raise HTTPException(status_code=400, detail='No credentials found.')
fastapi.exceptions.HTTPException: 400: No credentials found.
2025-02-28 10:00:50 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T04:30:50.752612', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': 'TestUser', 'org_id': 'TestOrg', 'details': {'duration_ms': 0.4260540008544922, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 10:01:28 - hubspot - ERROR - Error: HTTPException - 400: No credentials found. - Context: {'user_id': 'TestUser', 'org_id': 'TestOrg', 'integration': 'hubspot', 'operation': 'get_credentials'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 171, in get_credentials
    credentials = await get_credentials(self.integration_name, user_id, org_id)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 122, in get_credentials
    raise HTTPException(status_code=400, detail='No credentials found.')
fastapi.exceptions.HTTPException: 400: No credentials found.
2025-02-28 10:01:31 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T04:31:31.536888', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': 'TestUser', 'org_id': 'TestOrg', 'details': {'duration_ms': 1.0459423065185547, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 10:01:41 - hubspot - ERROR - Error: HTTPException - 400: No credentials found. - Context: {'user_id': 'TestUser', 'org_id': 'TestOrg', 'integration': 'hubspot', 'operation': 'get_credentials'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 171, in get_credentials
    credentials = await get_credentials(self.integration_name, user_id, org_id)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 122, in get_credentials
    raise HTTPException(status_code=400, detail='No credentials found.')
fastapi.exceptions.HTTPException: 400: No credentials found.
2025-02-28 10:02:38 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T04:32:38.492143', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': 'TestUser', 'org_id': 'TestOrg', 'details': {'duration_ms': 5.4378509521484375, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 10:12:47 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T04:42:47.758604', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': 'TestUser', 'org_id': 'TestOrg', 'details': {'duration_ms': 5.44285774230957, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 10:13:49 - hubspot - ERROR - Error: HTTPException - 400: No credentials found. - Context: {'user_id': 'TestUser', 'org_id': 'TestOrg', 'integration': 'hubspot', 'operation': 'get_credentials'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 171, in get_credentials
    credentials = await get_credentials(self.integration_name, user_id, org_id)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 122, in get_credentials
    raise HTTPException(status_code=400, detail='No credentials found.')
fastapi.exceptions.HTTPException: 400: No credentials found.
2025-02-28 10:22:40 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T04:52:40.626141', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': 'TestUser', 'org_id': 'TestOrg', 'details': {'duration_ms': 9.315013885498047, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 10:24:01 - hubspot - ERROR - Error: HTTPException - 400: No credentials found. - Context: {'user_id': 'TestUser', 'org_id': 'TestOrg', 'integration': 'hubspot', 'operation': 'get_credentials'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 171, in get_credentials
    credentials = await get_credentials(self.integration_name, user_id, org_id)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 122, in get_credentials
    raise HTTPException(status_code=400, detail='No credentials found.')
fastapi.exceptions.HTTPException: 400: No credentials found.
2025-02-28 10:56:22 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T05:26:22.267595', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': 'TestUser', 'org_id': 'TestOrg', 'details': {'duration_ms': 8.359909057617188, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 10:56:38 - hubspot - ERROR - Error: HTTPException - 400: No credentials found. - Context: {'user_id': 'TestUser', 'org_id': 'TestOrg', 'integration': 'hubspot', 'operation': 'get_credentials'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 184, in get_credentials
    credentials = await get_credentials(self.integration_name, user_id, org_id)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 349, in get_credentials
    raise HTTPException(status_code=400, detail='No credentials found.')
fastapi.exceptions.HTTPException: 400: No credentials found.
2025-02-28 11:09:39 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T05:39:39.152464', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': 'TestUser', 'org_id': 'TestOrg', 'details': {'duration_ms': 12.171745300292969, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 11:09:53 - hubspot - ERROR - Error: HTTPException - 415: Token exchange failed: <html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<title>Error 415 Unsupported Media Type</title>
</head>
<body><h2>HTTP ERROR 415</h2>
<p>Reason:
<pre>    Unsupported Media Type</pre></p>
</body>
</html>
 - Context: {'operation': 'oauth2callback', 'integration': 'hubspot'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 391, in oauth2callback
    credentials = await exchange_code_for_token(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 277, in exchange_code_for_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 415: Token exchange failed: <html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<title>Error 415 Unsupported Media Type</title>
</head>
<body><h2>HTTP ERROR 415</h2>
<p>Reason:
<pre>    Unsupported Media Type</pre></p>
</body>
</html>

2025-02-28 11:48:25 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T06:18:25.773535', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': 'rdgf', 'org_id': 'fhjgj', 'details': {'duration_ms': 0.9641647338867188, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 11:48:33 - hubspot - ERROR - Error: HTTPException - 415: Token exchange failed: <html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<title>Error 415 Unsupported Media Type</title>
</head>
<body><h2>HTTP ERROR 415</h2>
<p>Reason:
<pre>    Unsupported Media Type</pre></p>
</body>
</html>
 - Context: {'operation': 'oauth2callback', 'integration': 'hubspot'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 391, in oauth2callback
    credentials = await exchange_code_for_token(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 277, in exchange_code_for_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 415: Token exchange failed: <html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<title>Error 415 Unsupported Media Type</title>
</head>
<body><h2>HTTP ERROR 415</h2>
<p>Reason:
<pre>    Unsupported Media Type</pre></p>
</body>
</html>

2025-02-28 11:48:36 - hubspot - ERROR - Error: HTTPException - 400: No credentials found. - Context: {'user_id': 'rdgf', 'org_id': 'fhjgj', 'integration': 'hubspot', 'operation': 'get_credentials'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 447, in get_credentials
    credentials = await get_credentials(self.integration_name, user_id, org_id)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 349, in get_credentials
    raise HTTPException(status_code=400, detail='No credentials found.')
fastapi.exceptions.HTTPException: 400: No credentials found.
2025-02-28 11:56:42 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T06:26:42.200781', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': 'qwerty', 'org_id': 'qwerty', 'details': {'duration_ms': 7.827997207641602, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 11:56:48 - hubspot - ERROR - Error: HTTPException - 400: No credentials found. - Context: {'user_id': 'qwerty', 'org_id': 'qwerty', 'integration': 'hubspot', 'operation': 'get_credentials'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 447, in get_credentials
    credentials = await get_credentials(self.integration_name, user_id, org_id)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 349, in get_credentials
    raise HTTPException(status_code=400, detail='No credentials found.')
fastapi.exceptions.HTTPException: 400: No credentials found.
2025-02-28 14:18:29 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T08:48:29.343377', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': '12345678', 'org_id': '2q135w4e678oup9i', 'details': {'duration_ms': 6.573200225830078, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 14:18:40 - hubspot - ERROR - Error: HTTPException - 415: Token exchange failed: <html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<title>Error 415 Unsupported Media Type</title>
</head>
<body><h2>HTTP ERROR 415</h2>
<p>Reason:
<pre>    Unsupported Media Type</pre></p>
</body>
</html>
 - Context: {'operation': 'oauth2callback', 'integration': 'hubspot'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 138, in oauth2callback
    credentials = await exchange_code_for_token(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 148, in exchange_code_for_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 415: Token exchange failed: <html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<title>Error 415 Unsupported Media Type</title>
</head>
<body><h2>HTTP ERROR 415</h2>
<p>Reason:
<pre>    Unsupported Media Type</pre></p>
</body>
</html>

2025-02-28 14:27:44 - hubspot - ERROR - Error: HTTPException - 400: No credentials found. - Context: {'user_id': '12345678', 'org_id': '2q135w4e678oup9i', 'integration': 'hubspot', 'operation': 'get_credentials'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 194, in get_credentials
    credentials = await get_credentials(self.integration_name, user_id, org_id)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 220, in get_credentials
    raise HTTPException(status_code=400, detail='No credentials found.')
fastapi.exceptions.HTTPException: 400: No credentials found.
2025-02-28 14:27:56 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T08:57:56.183517', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': '12345678', 'org_id': '2q135w4e678oup9i', 'details': {'duration_ms': 0.640869140625, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 14:28:04 - hubspot - ERROR - Error: HTTPException - 415: Token exchange failed: <html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<title>Error 415 Unsupported Media Type</title>
</head>
<body><h2>HTTP ERROR 415</h2>
<p>Reason:
<pre>    Unsupported Media Type</pre></p>
</body>
</html>
 - Context: {'operation': 'oauth2callback', 'integration': 'hubspot'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 138, in oauth2callback
    credentials = await exchange_code_for_token(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 148, in exchange_code_for_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 415: Token exchange failed: <html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<title>Error 415 Unsupported Media Type</title>
</head>
<body><h2>HTTP ERROR 415</h2>
<p>Reason:
<pre>    Unsupported Media Type</pre></p>
</body>
</html>

2025-02-28 14:46:55 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:16:55.901374', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': '.', 'org_id': 'onefinnet', 'details': {'duration_ms': 9.474754333496094, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 14:47:08 - hubspot - ERROR - Error: HTTPException - 400: Token exchange failed: {"status":"BAD_CLIENT_ID","message":"missing or unknown client id","correlationId":"38c05d0c-5e12-46a3-8b37-34acc2530ec4"} - Context: {'operation': 'oauth2callback', 'integration': 'hubspot'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 138, in oauth2callback
    credentials = await exchange_code_for_token(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 193, in exchange_code_for_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 400: Token exchange failed: {"status":"BAD_CLIENT_ID","message":"missing or unknown client id","correlationId":"38c05d0c-5e12-46a3-8b37-34acc2530ec4"}
2025-02-28 14:56:08 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:26:08.332017', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': '.', 'org_id': 'onefinnet', 'details': {'duration_ms': 6.40106201171875, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 14:56:14 - hubspot - ERROR - Error: TypeError - unsupported operand type(s) for ** or pow(): 'str' and 'dict' - Context: {'operation': 'oauth2callback', 'integration': 'hubspot'}
Traceback (most recent call last):
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/integrations/base_integration.py", line 138, in oauth2callback
    credentials = await exchange_code_for_token(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/yashgupta/Downloads/vectorshift-assignment/backend/utils.py", line 182, in exchange_code_for_token
    "redirect_uri": config["redirect_uri"]
                    ~~~~~~~~~~~~~~~~~~~~~~
    **(additional_params or {})
    ^^~~~~~~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for ** or pow(): 'str' and 'dict'
2025-02-28 14:59:30 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:29:30.182154', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': '.', 'org_id': 'onefinnet', 'details': {'duration_ms': 11.824846267700195, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 14:59:36 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:29:36.307666', 'event_type': 'OAUTH_CALLBACK_SUCCESS', 'integration': 'hubspot', 'user_id': '.', 'org_id': 'onefinnet', 'details': {'duration_ms': 508.70704650878906, 'has_access_token': True}}
2025-02-28 14:59:36 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:29:36.484062', 'event_type': 'GET_CREDENTIALS', 'integration': 'hubspot', 'user_id': '.', 'org_id': 'onefinnet', 'details': {'duration_ms': 0.44798851013183594, 'success': True}}
2025-02-28 14:59:49 - hubspot - INFO - Starting HubSpot API calls for data retrieval
2025-02-28 14:59:50 - hubspot - INFO - HubSpot API calls completed in 1170.58ms
2025-02-28 14:59:50 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:29:50.626906', 'event_type': 'GET_ITEMS_COMPLETE', 'integration': 'hubspot', 'user_id': 'system', 'org_id': 'system', 'details': {'duration_ms': 1180.2828311920166, 'api_duration_ms': 1170.5808639526367, 'total_items': 3, 'stats': {'contacts': 2, 'companies': 1, 'deals': 0, 'errors': 0}}}
2025-02-28 14:59:50 - hubspot - INFO - Total HubSpot items retrieved: 3
2025-02-28 15:00:55 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:30:55.491045', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': '123', 'org_id': '123e', 'details': {'duration_ms': 8.108139038085938, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 15:01:03 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:31:03.188779', 'event_type': 'OAUTH_CALLBACK_SUCCESS', 'integration': 'hubspot', 'user_id': '123', 'org_id': '123e', 'details': {'duration_ms': 878.5147666931152, 'has_access_token': True}}
2025-02-28 15:01:03 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:31:03.229826', 'event_type': 'GET_CREDENTIALS', 'integration': 'hubspot', 'user_id': '123', 'org_id': '123e', 'details': {'duration_ms': 2.8748512268066406, 'success': True}}
2025-02-28 15:05:59 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:35:59.825042', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': 'wrqetyiu', 'org_id': 'q23w5e6r7t8y98', 'details': {'duration_ms': 9.325027465820312, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 15:06:07 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:36:07.462423', 'event_type': 'OAUTH_CALLBACK_SUCCESS', 'integration': 'hubspot', 'user_id': 'wrqetyiu', 'org_id': 'q23w5e6r7t8y98', 'details': {'duration_ms': 484.4930171966553, 'has_access_token': True}}
2025-02-28 15:06:07 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:36:07.489150', 'event_type': 'GET_CREDENTIALS', 'integration': 'hubspot', 'user_id': 'wrqetyiu', 'org_id': 'q23w5e6r7t8y98', 'details': {'duration_ms': 0.51116943359375, 'success': True}}
2025-02-28 15:13:56 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:43:56.987122', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': '123', 'org_id': '1235465', 'details': {'duration_ms': 1.3508796691894531, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 15:14:04 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:44:04.435519', 'event_type': 'OAUTH_CALLBACK_SUCCESS', 'integration': 'hubspot', 'user_id': '123', 'org_id': '1235465', 'details': {'duration_ms': 471.2519645690918, 'has_access_token': True}}
2025-02-28 15:14:04 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:44:04.474953', 'event_type': 'GET_CREDENTIALS', 'integration': 'hubspot', 'user_id': '123', 'org_id': '1235465', 'details': {'duration_ms': 1.2848377227783203, 'success': True}}
2025-02-28 15:17:37 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:47:37.935516', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': '31254676', 'org_id': '23q3w5e6r78t', 'details': {'duration_ms': 0.8392333984375, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 15:17:45 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:47:45.399673', 'event_type': 'OAUTH_CALLBACK_SUCCESS', 'integration': 'hubspot', 'user_id': '31254676', 'org_id': '23q3w5e6r78t', 'details': {'duration_ms': 457.63397216796875, 'has_access_token': True}}
2025-02-28 15:17:45 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:47:45.429935', 'event_type': 'GET_CREDENTIALS', 'integration': 'hubspot', 'user_id': '31254676', 'org_id': '23q3w5e6r78t', 'details': {'duration_ms': 0.41866302490234375, 'success': True}}
2025-02-28 15:18:50 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:48:50.907430', 'event_type': 'AUTHORIZE_START', 'integration': 'hubspot', 'user_id': '12345y', 'org_id': '234657t', 'details': {'duration_ms': 7.4291229248046875, 'redirect_uri': 'http://localhost:8000/integrations/hubspot/oauth2callback'}}
2025-02-28 15:18:57 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:48:57.420503', 'event_type': 'OAUTH_CALLBACK_SUCCESS', 'integration': 'hubspot', 'user_id': '12345y', 'org_id': '234657t', 'details': {'duration_ms': 449.76091384887695, 'has_access_token': True}}
2025-02-28 15:18:57 - hubspot - INFO - Integration Event: {'timestamp': '2025-02-28T09:48:57.446305', 'event_type': 'GET_CREDENTIALS', 'integration': 'hubspot', 'user_id': '12345y', 'org_id': '234657t', 'details': {'duration_ms': 0.3960132598876953, 'success': True}}
